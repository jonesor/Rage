<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suggested Quality Control • Rage</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Suggested Quality Control">
<meta property="og:description" content="Rage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_GettingStarted.html">Getting started with Rage</a>
    </li>
    <li>
      <a href="../articles/a02_VitalRates.html">Deriving vital rates from an MPM</a>
    </li>
    <li>
      <a href="../articles/a03_LifeHistoryTraits.html">Deriving life history traits from an MPM</a>
    </li>
    <li>
      <a href="../articles/a04_AgeFromStage.html">Age-from-stage analyses</a>
    </li>
    <li>
      <a href="../articles/a05_SuggestedQualityControl.html">Suggested Quality Control</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jonesor/Rage/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a05_SuggestedQualityControl_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Suggested Quality Control</h1>
                        <h4 class="author">Owen Jones</h4>
            
            <h4 class="date">2021-10-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jonesor/Rage/blob/master/vignettes/a05_SuggestedQualityControl.Rmd"><code>vignettes/a05_SuggestedQualityControl.Rmd</code></a></small>
      <div class="hidden name"><code>a05_SuggestedQualityControl.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The specific requirements and assumptions for each function in <code>Rage</code> varies. Here we provide notes that give an overview of these factors, which can be conveniently identified using the function <code><a href="https://rdrr.io/pkg/Rcompadre/man/cdb_flag.html">Rcompadre::cdb_flag</a></code> (note that this function is automatically run by <code><a href="https://rdrr.io/pkg/Rcompadre/man/cdb_fetch.html">Rcompadre::cdb_fetch</a></code> if it is run with argument <code>flag = TRUE</code>).</p>
</div>
<div id="types-of-issue" class="section level1">
<h1 class="hasAnchor">
<a href="#types-of-issue" class="anchor"></a>Types of issue</h1>
<div id="missing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#missing-data" class="anchor"></a>Missing data</h2>
<p>The most obvious requirement for most of the <code>Rage</code> methods is that missing (<code>NA</code>) values in matrices prevent calculations using those matrices. Sometimes these <code>NA</code> values are in one of the submatrices (i.e., <strong>U</strong>, <strong>F</strong> or <strong>C</strong>) of the matrix model, but other submatrices are complete. For example, there may be <code>NA</code> entries in the <strong>F</strong> submatrix, but the <strong>U</strong> matrix remains complete. These are flagged with the columns <code>check_NA_A</code>, <code>check_NA_U</code>, <code>check_NA_F</code> and <code>check_NA_C</code>.</p>
</div>
<div id="excessive-zeros" class="section level2">
<h2 class="hasAnchor">
<a href="#excessive-zeros" class="anchor"></a>Excessive zeros</h2>
<p>A related issue occurs when an submatrix is entirely composed of zero values. There may be good reasons for this: For example, species that do not reproduce clonally will have zero-value <strong>C</strong> matrices; or in the particular focal population in the particular focal year, there was no sexual reproduction recorded, so the <strong>F</strong> matrix was composed entirely of zeros). Nevertheless, zero-value submatrices can cause some calculations to fail and it may be necessary to exclude them. These issues are flagged with the columns <code>check_zero_F</code>, <code>check_zero_C</code>, <code>check_zero_U</code>.</p>
</div>
<div id="excessive-mortality" class="section level2">
<h2 class="hasAnchor">
<a href="#excessive-mortality" class="anchor"></a>Excessive mortality</h2>
<p>Similarly, there may be some matrices where the column sums of the <strong>U</strong> matrix are zero, implying that there is no survival from that particular stage. This may be a perfectly valid parameterisation for a particular year/place but is biologically unreasonable in the longer term. This is indicated with the column <code>check_zero_U_colsum</code>.</p>
</div>
<div id="excessive-survival" class="section level2">
<h2 class="hasAnchor">
<a href="#excessive-survival" class="anchor"></a>Excessive survival</h2>
<p>In a biologically reasonable MPM, the set of survival and growth transitions (i.e. in <strong>matU</strong>) from a stage should not exceed 1. We can examine this by looking at the column sums of the <strong>U</strong> matrix. However, in some cases, errors in the original matrices (which may be rounding errors) cause this to occur. This is flagged using the column <code>check_surv_gte_1</code>. An additional column <code>SurvivalIssue</code> gives the maximum value of the column sums.</p>
</div>
<div id="reducibility-and-ergodicity" class="section level2">
<h2 class="hasAnchor">
<a href="#reducibility-and-ergodicity" class="anchor"></a>Reducibility and ergodicity</h2>
<p>Additional requirements include that the MPM (<strong>A</strong>) be irreducible and ergodic. Irreducible MPMs are those where parameterised transition rates facilitate pathways from all stages to all other stages. Conversely, reducible MPMs depict incomplete life cycles where pathways from all stages to every other stage are not possible. Ergodic MPMs are those where there is a <em>single</em> asymptotic stable state that does not depend on initial stage structure. Conversely, nonergodic MPMs are those where there are multiple asymptotic stable states, which depend on initial stage structure. MPMs that are reducible and/or non-ergodic are usually biologically unreasonable, both in terms of their life cycle description and their projected dynamics. They cause most analytical methods in <code>Rage</code> to fail. These issues are flagged with <code>check_irreducible</code> and <code>check_ergodic</code>.</p>
<p>The related issue of primitivity is flagged with <code>check_primitive</code></p>
</div>
<div id="singularity-of-the-u-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#singularity-of-the-u-matrix" class="anchor"></a>Singularity of the U matrix</h2>
<p>Singular matrices cannot be inverted, and because inversion is required for many matrix calculations this can cause problems. This issue is flagged with <code>check_singular_U</code>.</p>
</div>
<div id="matrix-split-errors" class="section level2">
<h2 class="hasAnchor">
<a href="#matrix-split-errors" class="anchor"></a>Matrix split errors</h2>
<p>A complete MPM (<strong>A</strong>) can be split into its component submatrices (i.e. <strong>U</strong>, <strong>F</strong> and <strong>C</strong>). The sum of these submatrices should equal the complete MPM (i.e. <strong>A</strong> = <strong>U</strong> + <strong>F</strong> + <strong>C</strong>). Sometimes, however, errors occur so that the submatrices do NOT sum to <strong>A</strong>. Normally, this is caused by rounding errors, but more significant errors are possible. This problem is flagged with <code>check_component_sum</code> (only for divided (split) matrices).</p>
</div>
</div>
<div id="function-requirement-summaries" class="section level1">
<h1 class="hasAnchor">
<a href="#function-requirement-summaries" class="anchor"></a>Function requirement summaries</h1>
<p><code>age_from_stage</code> is a set of functions (<code>mpm_to_hx</code>, <code>mpm_to_lx</code>, <code>mpm_to_mx</code>, <code>mpm_to_px</code>) which, together with the function <code>mpm_to_table</code>, use age-from-stage decomposition methods to generate life tables, or specific life table columns (<code>hx</code>, <code>lx</code>, <code>mx</code> or <code>px</code>). At the least, functions require complete <code>matU</code> with no missing (<code>NA</code>) values and where none of the <code>matU</code> columns sum to zero, and (optionally) a complete <code>matF</code>.</p>
<p><code>gen_time</code> requires a U matrix <code>matU</code> and a matrix representing reproduction which can be , , or the sum of both of these. The <code>matU</code> matrix must complete <code>matU</code> with no missing (<code>NA</code>) values and where none of the <code>matU</code> columns sum to zero. The reproduction matrix must be complete with no <code>NA</code> values. It is also recommended that the complete <code>matA</code> from which the submatrices are derived be ergodic and irreducible.</p>
<p><code>life_expect_mean</code> and <code>life_expect_var</code> require a U matrix (<code>matU</code>) with no missing (<code>NA</code>) values. In addition, none of the <code>matU</code> columns should sum to zero.</p>
<p><code>longevity</code> requires a U matrix (<code>matU</code>) with no missing (<code>NA</code>) values and where none of the <code>matU</code> columns sum to zero. Users should be aware of the issue of convergence to quasi-stationary distribution (see ).</p>
<p><code>mature_age</code>,<code>mature_distrib</code> and <code>mature_prob</code></p>
<p><code>qsd_converge</code></p>
<p><code>net_repro_rate</code> requires a <code>matU</code> and <code>matR</code> (which can be a <code>matF</code>, <code>matC</code> or the sum of both). The matrices must be complete with no <code>NA</code> values. <code>mpm_collapse</code> requires a <code>matU</code> and <code>matR</code> (which can be a <code>matF</code>, <code>matC</code> or the sum of both).</p>
<p><code>mpm_rearrange</code> requires a <code>matU</code> and <code>matF</code> (and optionally <code>matC</code>).</p>
<p><code>mpm_split</code> requires a <code>matA</code> matrix.</p>
<p><code>mpm_standardise</code> (<code>mpm_standardize</code>) requires a <code>matU</code> and <code>matF</code> (and optionally <code>matC</code>).</p>
<p><code>perturb_matrix</code> requires <code>matA</code></p>
<p><code>perturb_stochastic</code> requires a <code>list</code> of matrix population models <code>matA</code>.</p>
<p><code>perturb_trans</code> requires <code>matU</code> and <code>matF</code> (and optionally <code>matC</code>).</p>
<p><code>perturb_vr</code> requires <code>matU</code> and <code>matF</code> (and optionally <code>matC</code>).</p>
<p><code>plot_life_cycle</code> requires a full matrix population model (<code>matA</code>) with no missing (<code>NA</code>) values.</p>
<p><code>vr_mat</code> functions (<code>vr_mat_U</code> and <code>vr_mat_R</code>). Require a complete <code>matU</code>, and both <code>matU</code> and <code>matR</code> respectively.</p>
<p><code>vr</code> functions (<code>vr_survival</code>, <code>vr_growth</code>, <code>vr_shrinkage</code>, <code>vr_stasis</code>, <code>vr_dorm_enter</code>, <code>vr_dorm_exit</code>, <code>vr_fecundity</code>) require <code>matU</code> (and for <code>vr_fecundity</code> <code>matR</code>, which can be <code>matF</code>, <code>matC</code> or the sum of both)</p>
<p><code>vital_rates</code> requires at least <code>matU</code> and <code>matF</code>. The inclusion of <code>matF</code> is optional. All matrices must be complete with no missing (<code>NA</code>) values.</p>
<p>The <code>vr_vec...</code> functions (<code>vr_vec_dorm_enter</code>, <code>vr_vec_dorm_exit</code>, <code>vr_vec_growth</code>, <code>vr_vec_shrinkage</code>, <code>vr_vec_stasis</code>, <code>vr_vec_survival</code> and <code>vr_vec_reproduction</code>) require at least <code>matU</code>. The function <code>vr_vec_reproduction</code> also requires <code>matR</code>, which can be a <code>matF</code> matrix, <code>matC</code> matrix, or the sum of both.</p>
</div>
<div id="functions-that-do-not-require-matrices" class="section level1">
<h1 class="hasAnchor">
<a href="#functions-that-do-not-require-matrices" class="anchor"></a>Functions that do not require matrices</h1>
<p>Several functions in <code>Rage</code> do not directly require matrices as inputs, but rather require <code>lx</code>, <code>mx</code> etc. However, several of the issues above should be considered if these trajectories are derived from matrices. (see the <code>age_from_stage</code> section above)</p>
<p><code>shape_rep</code> and <code>shape_surv</code> require <code>mx</code> reproduction and <code>lx</code> schedules over age respectively.</p>
<p>The functions <code>hx_to_lx</code>, <code>hx_to_px</code>, <code>lx_to_hx</code>, <code>lx_to_px</code>, <code>px_to_hx</code>, <code>px_to_lx</code> allow conversion among <code>hx</code>, <code>lx</code> and <code>px</code> trajectories using standard life table calculations.</p>
<p><code>entropy_d</code> and <code>entropy_d</code> require <code>lx</code> trajectories that are generated from a matrix model using the <code>mpm_to_table</code>, or <code>mpm_to_lx</code> functions. Users should be aware of the issue of convergence to quasi-stationary distribution (see ).</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Patrick Barks, Pol Capdevila, Hal Caswell, Judy P. Che-Castaldo, John Jackson, Tamora James, Owen Jones, Sam Levin, William K. Petry, Roberto Salguero-Gomez, Iain Stott, Chelsea C. Thomas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
