<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Derive stage-specific vital rates from a matrix population model — vr_vec • Rage</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Derive stage-specific vital rates from a matrix population model — vr_vec"><meta property="og:description" content="Derive a vector of stage-specific vital rates of survival, growth, shrinkage,
stasis, dormancy, or reproduction from a matrix population model. These
functions include optional arguments for excluding certain stage classes from
the calculation (see Excluding stages), and defining the set of
biologically-possible transitions (see Possible transitions).
This decomposition assume that all transition rates are products of a
stage-specific survival term (column sums of matU) and a lower level
vital rate that is conditional on survival (growth, shrinkage, stasis,
dormancy, or reproduction). Reproductive vital rates that are not conditional
on survival (i.e., within a stage class from which there is no survival) are
also allowed."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a01_GettingStarted.html">Getting started with Rage</a>
    </li>
    <li>
      <a href="../articles/a02_VitalRates.html">Deriving vital rates from an MPM</a>
    </li>
    <li>
      <a href="../articles/a03_LifeHistoryTraits.html">Deriving life history traits from an MPM</a>
    </li>
    <li>
      <a href="../articles/a04_AgeFromStage.html">Age-from-stage analyses</a>
    </li>
    <li>
      <a href="../articles/a05_SuggestedQualityControl.html">Suggested quality control</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jonesor/Rage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Derive stage-specific vital rates from a matrix population model</h1>
    <small class="dont-index">Source: <a href="https://github.com/jonesor/Rage/blob/HEAD/R/vr_vec.R" class="external-link"><code>R/vr_vec.R</code></a></small>
    <div class="hidden name"><code>vr_vec.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Derive a vector of stage-specific vital rates of survival, growth, shrinkage,
stasis, dormancy, or reproduction from a matrix population model. These
functions include optional arguments for excluding certain stage classes from
the calculation (see <em>Excluding stages</em>), and defining the set of
biologically-possible transitions (see <em>Possible transitions</em>).</p>
<p>This decomposition assume that all transition rates are products of a
stage-specific survival term (column sums of <code>matU</code>) and a lower level
vital rate that is conditional on survival (growth, shrinkage, stasis,
dormancy, or reproduction). Reproductive vital rates that are not conditional
on survival (i.e., within a stage class from which there is no survival) are
also allowed.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vr_vec_survival</span><span class="op">(</span><span class="va">matU</span>, posU <span class="op">=</span> <span class="va">matU</span> <span class="op">&gt;</span> <span class="fl">0</span>, exclude_col <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vr_vec_growth</span><span class="op">(</span></span>
<span>  <span class="va">matU</span>,</span>
<span>  posU <span class="op">=</span> <span class="va">matU</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>  exclude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclude_row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclude_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  surv_only_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vr_vec_shrinkage</span><span class="op">(</span></span>
<span>  <span class="va">matU</span>,</span>
<span>  posU <span class="op">=</span> <span class="va">matU</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>  exclude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclude_row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exclude_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  surv_only_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vr_vec_stasis</span><span class="op">(</span><span class="va">matU</span>, posU <span class="op">=</span> <span class="va">matU</span> <span class="op">&gt;</span> <span class="fl">0</span>, exclude <span class="op">=</span> <span class="cn">NULL</span>, surv_only_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vr_vec_dorm_enter</span><span class="op">(</span><span class="va">matU</span>, posU <span class="op">=</span> <span class="va">matU</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">dorm_stages</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vr_vec_dorm_exit</span><span class="op">(</span><span class="va">matU</span>, posU <span class="op">=</span> <span class="va">matU</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">dorm_stages</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vr_vec_reproduction</span><span class="op">(</span></span>
<span>  <span class="va">matU</span>,</span>
<span>  <span class="va">matR</span>,</span>
<span>  posR <span class="op">=</span> <span class="va">matR</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>  exclude_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights_row <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>matU</dt>
<dd><p>The survival component of a matrix population model (i.e., a
square projection matrix only containing survival-related transitions;
progression, stasis, and retrogression).</p></dd>


<dt>posU</dt>
<dd><p>A logical matrix of the same dimension as <code>matU</code>, with
elements indicating whether a given <code>matU</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matU &gt; 0</code> (see
Details).</p></dd>


<dt>exclude_col</dt>
<dd><p>Integer, character or logical vector indicating stages for
which transitions both <em>to</em> and <em>from</em> the stage should be
excluded from the calculation of vital rates. See section
<em>Excluding stages</em>.</p></dd>


<dt>exclude</dt>
<dd><p>Integer, character or logical vector indicating stages for
which transitions both <em>to</em> and <em>from</em> the stage should be
excluded from the calculation of vital rates. See section
<em>Excluding stages</em>.</p></dd>


<dt>exclude_row</dt>
<dd><p>Integer, character or logical vector indicating stages for
which transitions both <em>to</em> and <em>from</em> the stage should be
excluded from the calculation of vital rates. See section
<em>Excluding stages</em>.</p></dd>


<dt>surv_only_na</dt>
<dd><p>If there is only one possible <code>matU</code> transition in a
given column, should that transition be attributed exclusively to survival?
If <code>TRUE</code>, the vital rate of growth/stasis/shrinkage in that column
will be coerced to <code>NA</code>. If <code>FALSE</code>, dividing the single
transition by the stage-specific survival probability will always yield a
value of <code>1</code>. Defaults to <code>TRUE</code>.</p></dd>


<dt>dorm_stages</dt>
<dd><p>Integer or character vector indicating dormant stage
classes.</p></dd>


<dt>matR</dt>
<dd><p>The reproductive component of a matrix population model (i.e., a
square projection matrix only reflecting transitions due to reproduction;
either sexual, clonal, or both).</p></dd>


<dt>posR</dt>
<dd><p>A logical matrix of the same dimension as <code>matR</code>, with
elements indicating whether a given <code>matR</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matR &gt; 0</code> (see
Details).</p></dd>


<dt>weights_row</dt>
<dd><p>Vector of stage-specific weights to apply while summing
vital rates across rows within columns (e.g., reproductive value vector).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Vector of vital rates. Vital rates corresponding to impossible
  transitions are coerced to <code>NA</code> (see <em>Possible transitions</em>).</p>
    </div>
    <div id="possible-transitions">
    <h2>Possible transitions</h2>
    

<p>A transition rate of <code>0</code> within a matrix population model may indicate
that the transition is not possible in the given life cycle (e.g., tadpoles
never revert to eggs), or that the transition rate is possible but was
estimated to be <code>0</code> in the relevant population and time period. If vital
rates are to be averaged across multiple stage classes, or compared across
populations, it may be important to distinguish between these two types of
zeros.</p>
<p>By default, the <code>vitals_</code> functions assume that a transition rate of
<code>0</code> indicates an impossible transition, in which case a value of
<code>NA</code> will be used in relevant calculations. Specifically, the arguments
<code>posU</code> and <code>posR</code> are specified by the logical expressions
<code>(matU &gt; 0)</code> and <code>(matR &gt; 0)</code>, respectively. If the matrix
population model includes transitions that are estimated to be <code>0</code> but
still in fact possible, one should specify the <code>posU</code> and/or <code>posR</code>
arguments manually.</p>
    </div>
    <div id="excluding-stages">
    <h2>Excluding stages</h2>
    

<p>It may be desirable to exclude one or more stages from the calculation of
certain vital rates. For instance, a user might not believe that 'growth' to
a dormant stage class really reflects biological growth, in which case the
user could exclude transitions <em>to</em> the dormant stage class using the
argument <code>exclude_row</code>. The user may or may not want to ignore 'growth'
transitions <em>from</em> the dormant stage class, which can be done using
<code>exclude_col</code>. The argument <code>exclude_col</code> effectively just coerces
the respective vital rate to <code>NA</code>, to prevent it from getting used in
subsequent calculations. To exclude transitions both <em>to and from</em> a
given set of stages, use argument <code>exclude</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other vital rates: 
<code><a href="vital_rates.html">vital_rates</a>()</code>,
<code><a href="vr_mat.html">vr_mat</a></code>,
<code><a href="vr.html">vr</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Patrick Barks &lt;patrick.barks@gmail.com&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># create example MPM (stage 4 is dormant)</span></span></span>
<span class="r-in"><span><span class="va">matU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">matR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.7</span>, <span class="fl">1.1</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.8</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">vr_vec_survival</span><span class="op">(</span><span class="va">matU</span>, exclude_col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6 0.5 0.9  NA</span>
<span class="r-in"><span><span class="fu">vr_vec_growth</span><span class="op">(</span><span class="va">matU</span>, exclude <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8333333 0.6000000        NA        NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># `exclude*` and `*_stages` arguments can accept stage names</span></span></span>
<span class="r-in"><span><span class="va">matU</span> <span class="op">&lt;-</span> <span class="fu"><a href="name_stages.html">name_stages</a></span><span class="op">(</span><span class="va">matU</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">matR</span> <span class="op">&lt;-</span> <span class="fu"><a href="name_stages.html">name_stages</a></span><span class="op">(</span><span class="va">matR</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">vr_vec_shrinkage</span><span class="op">(</span><span class="va">matU</span>, exclude <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   stage_1   stage_2   stage_3   stage_4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA        NA 0.1111111        NA </span>
<span class="r-in"><span><span class="fu">vr_vec_stasis</span><span class="op">(</span><span class="va">matU</span>, exclude <span class="op">=</span> <span class="st">"stage_4"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   stage_1   stage_2   stage_3   stage_4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1666667 0.4000000 0.3333333        NA </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">vr_vec_dorm_enter</span><span class="op">(</span><span class="va">matU</span>, dorm_stages <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   stage_1   stage_2   stage_3   stage_4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA        NA 0.5555556        NA </span>
<span class="r-in"><span><span class="fu">vr_vec_dorm_exit</span><span class="op">(</span><span class="fu"><a href="name_stages.html">name_stages</a></span><span class="op">(</span><span class="va">matU</span><span class="op">)</span>, dorm_stages <span class="op">=</span> <span class="st">"stage_4"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Existing stage names have been overwritten!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   stage_1   stage_2   stage_3   stage_4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA        NA        NA 0.3333333 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">vr_vec_reproduction</span><span class="op">(</span><span class="va">matU</span>, <span class="va">matR</span>, exclude_col <span class="op">=</span> <span class="st">"stage_4"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  stage_1  stage_2  stage_3  stage_4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA 2.000000 2.111111       NA </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Barks, Pol Capdevila, Hal Caswell, Judy P. Che-Castaldo, Richard A. Hinrichsen, John Jackson, Tamora James, Owen Jones, Sam Levin, William K. Petry, Roberto Salguero-Gomez, Iain Stott, Chelsea C. Thomas, Christina M. Hernández, Lotte de Vries, Stefano Giaimo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

