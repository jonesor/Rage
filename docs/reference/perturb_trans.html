<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perturbation analysis of transition types within a matrix population model — perturb_trans • Rage</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perturbation analysis of transition types within a matrix population model — perturb_trans" />
<meta property="og:description" content="Calculates the summed sensitivities or elasticities for various
transition types within a matrix population model (MPM), including stasis,
retrogression, progression, fecundity, and clonality.
Sensitivities or elasticities are calculated by perturbing elements of the
MPM and measuring the response of the per-capita population growth rate at
equilibrium (\(\lambda\)), or, with a user-supplied function, any other
demographic statistic." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/a01_GettingStarted.html">Getting started with `Rage`</a>
    </li>
    <li>
      <a href="../articles/a02_VitalRates.html">Deriving vital rates from an MPM</a>
    </li>
    <li>
      <a href="../articles/a03_AgeFromStage.html">Age-from-stage analyses</a>
    </li>
    <li>
      <a href="../articles/a04_TernaryPlots.html">Ternary Plots</a>
    </li>
    <li>
      <a href="../articles/a05_LifeHistoryTraits.html">Deriving life history traits from an MPM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jonesor/Rage/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perturbation analysis of transition types within a matrix population model</h1>
    <small class="dont-index">Source: <a href='https://github.com/jonesor/Rage/blob/master/R/perturb_trans.R'><code>R/perturb_trans.R</code></a></small>
    <div class="hidden name"><code>perturb_trans.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the summed sensitivities or elasticities for various
transition types within a matrix population model (MPM), including stasis,
retrogression, progression, fecundity, and clonality.</p>
<p>Sensitivities or elasticities are calculated by perturbing elements of the
MPM and measuring the response of the per-capita population growth rate at
equilibrium (\(\lambda\)), or, with a user-supplied function, any other
demographic statistic.</p>
    </div>

    <pre class="usage"><span class='fu'>perturb_trans</span><span class='op'>(</span>
  <span class='va'>matU</span>,
  <span class='va'>matF</span>,
  matC <span class='op'>=</span> <span class='cn'>NULL</span>,
  posU <span class='op'>=</span> <span class='va'>matU</span> <span class='op'>&gt;</span> <span class='fl'>0</span>,
  posF <span class='op'>=</span> <span class='va'>matF</span> <span class='op'>&gt;</span> <span class='fl'>0</span>,
  posC <span class='op'>=</span> <span class='va'>matC</span> <span class='op'>&gt;</span> <span class='fl'>0</span>,
  exclude_row <span class='op'>=</span> <span class='cn'>NULL</span>,
  exclude_col <span class='op'>=</span> <span class='cn'>NULL</span>,
  pert <span class='op'>=</span> <span class='fl'>1e-06</span>,
  type <span class='op'>=</span> <span class='st'>"sensitivity"</span>,
  demog_stat <span class='op'>=</span> <span class='st'>"lambda"</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>matU</th>
      <td><p>The survival component submatrix of a MPM (i.e. a square projection matrix
reflecting survival-related transitions; e.g. progression, stasis, and
retrogression).</p></td>
    </tr>
    <tr>
      <th>matF</th>
      <td><p>The sexual component submatrix of a MPM (i.e. a square projection matrix
reflecting transitions due to sexual reproduction).</p></td>
    </tr>
    <tr>
      <th>matC</th>
      <td><p>The clonal component submatrix of a MPM (i.e. a square projection matrix
reflecting transitions due to clonal reproduction). Defaults to
<code>NULL</code>, indicating no clonal reproduction possible.</p></td>
    </tr>
    <tr>
      <th>posU</th>
      <td><p>A logical matrix of the same dimension as <code>matU</code>, with
elements indicating whether a given <code>matU</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matU &gt; 0</code> (see
Details).</p></td>
    </tr>
    <tr>
      <th>posF</th>
      <td><p>A logical matrix of the same dimension as <code>matF</code>, with
elements indicating whether a given <code>matF</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matF &gt; 0</code> (see
Details).</p></td>
    </tr>
    <tr>
      <th>posC</th>
      <td><p>A logical matrix of the same dimension as <code>matC</code>, with
elements indicating whether a given <code>matC</code> transition is possible
(<code>TRUE</code>) or not (<code>FALSE</code>). Defaults to <code>matC &gt; 0</code> (see
Details).</p></td>
    </tr>
    <tr>
      <th>exclude_row</th>
      <td><p>An integer or logical vector indicating stages for which
transitions <em>to</em> the stage should be excluded from perturbation
analysis. See section <em>Excluding stages</em>.</p></td>
    </tr>
    <tr>
      <th>exclude_col</th>
      <td><p>An integer or logical vector indicating stages for which
transitions <em>from</em> the stage should be excluded from perturbation
analysis. See section <em>Excluding stages</em>.</p></td>
    </tr>
    <tr>
      <th>pert</th>
      <td><p>The magnitude of the perturbation (defaults to <code>1e-6</code>).</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>An argument defining whether to return `sensitivity` or
`elasticity` values. Defaults to `sensitivity`.</p></td>
    </tr>
    <tr>
      <th>demog_stat</th>
      <td><p>An argument defining which demographic statistic should be
used, as in "the sensitivity/elasticity of <code>demog_stat</code> to matrix
element perturbations." Defaults to the per-capita population growth rate
at equilibrium (\(lambda\)). Also accepts a user-supplied function that
performs a calculation on a MPM and returns a single numeric value.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to the function <code>demog_stat</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with 5 elements:</p>
<dt>stasis</dt><dd><p>The sensitivity or elasticity
  of <code>demog_stat</code> to stasis.</p></dd> <dt>retrogression</dt><dd><p>The sensitivity or
  elasticity of <code>demog_stat</code> to retrogression.</p></dd> <dt>progression</dt><dd><p>The
  sensitivity or elasticity of <code>demog_stat</code> to progression.</p></dd>
  <dt>fecundity</dt><dd><p>The sensitivity or elasticity of <code>demog_stat</code> to
  sexual fecundity.</p></dd> <dt>clonality</dt><dd><p>The sensitivity or elasticity of
  <code>demog_stat</code> to clonality.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A transition rate of <code>0</code> within a matrix population model can
either indicate that the transition is not possible in the given life cycle
(e.g. tadpoles never revert to eggs), or that the transition is possible but
was estimated to be <code>0</code> in the relevant population and time period.
Because transition rates of zero <em>do</em> generally yield non-zero
sensitivities, it is important to distinguish between structural (i.e.
impossible) zeros and sampled zeros when summing multiple sensitivities for a
given process (e.g. progression/growth).</p>
<p>By default, the <code>perturb_</code> functions assume that a transition rate of
<code>0</code> indicates an impossible transition, in which case the sensitivity
for that transition will not be included in any calculation. Specifically,
the arguments <code>posX</code> are specified by the logical expression <code>(matX
&gt; 0)</code>. If the matrix population model includes transitions that are possible
but estimated to be <code>0</code>, users should specify the <code>posX</code>
argument(s) manually.</p>
<p>If there are no possible transitions for a given process (e.g. clonality, in many species),
the value of sensitivity or elasticity returned for that process will be
<code>NA</code>.</p>
    <h2 class="hasAnchor" id="excluding-stages"><a class="anchor" href="#excluding-stages"></a>Excluding stages</h2>

    <p>It may be desirable to exclude one or more stages
  from the calculation. For instance, we might not believe that 'progression'
  to a dormant stage class truly reflects progression. In this case we could
  exclude transitions <em>to</em> the dormant stage class using the argument
  <code>exclude_row</code>. We may or may not want to ignore progression
  transitions <em>from</em> the dormant stage class, which can be done in a
  similar way using the argument <code>exclude_col</code>. The <code>exclude_</code>
  arguments simply set the relevant row or column of the <code>posX</code>
  arguments to <code>FALSE</code>, to prevent those transitions from being used in
  subsequent calculations.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other perturbation analysis: 
<code><a href='perturb_matrix.html'>perturb_matrix</a>()</code>,
<code><a href='perturb_stochastic.html'>perturb_stochastic</a>()</code>,
<code><a href='perturb_vr.html'>perturb_vr</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Rob Salguero-Gómez &lt;rob.salguero@zoo.ox.ac.uk&gt;</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>matU</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>,   <span class='fl'>0</span>,   <span class='fl'>0</span>,   <span class='fl'>0</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>,   <span class='fl'>0</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>0</span>, <span class='fl'>0.3</span>, <span class='fl'>0.3</span>, <span class='fl'>0.1</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>0</span>,   <span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>0.6</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>matF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>0</span>,   <span class='fl'>0</span>, <span class='fl'>1.1</span>, <span class='fl'>1.6</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>0</span>,   <span class='fl'>0</span>, <span class='fl'>0.8</span>, <span class='fl'>0.4</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>0</span>,   <span class='fl'>0</span>,   <span class='fl'>0</span>,   <span class='fl'>0</span><span class='op'>)</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>0</span>,   <span class='fl'>0</span>,   <span class='fl'>0</span>,   <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>


<span class='fu'>perturb_trans</span><span class='op'>(</span><span class='va'>matU</span>, <span class='va'>matF</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $stasis
#&gt; [1] 1.000001
#&gt; 
#&gt; $retro
#&gt; [1] 0.4171896
#&gt; 
#&gt; $progr
#&gt; [1] 1.428538
#&gt; 
#&gt; $fecundity
#&gt; [1] 0.3016217
#&gt; 
#&gt; $clonality
#&gt; [1] NA
#&gt; </div><div class='input'>
<span class='co'># Use a larger perturbation than the default of 1e-6.</span>
<span class='fu'>perturb_trans</span><span class='op'>(</span><span class='va'>matU</span>, <span class='va'>matF</span>, pert <span class='op'>=</span> <span class='fl'>0.01</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $stasis
#&gt; [1] 1.005989
#&gt; 
#&gt; $retro
#&gt; [1] 0.4167755
#&gt; 
#&gt; $progr
#&gt; [1] 1.418785
#&gt; 
#&gt; $fecundity
#&gt; [1] 0.3014444
#&gt; 
#&gt; $clonality
#&gt; [1] NA
#&gt; </div><div class='input'>
<span class='co'># Calculate the sensitivity/elasticity of the damping ratio to perturbations.</span>
<span class='co'># First, define function for damping ratio:</span>
<span class='va'>damping</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>matA</span><span class='op'>)</span> <span class='op'>{</span>  
  <span class='va'>eig</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/eigen.html'>eigen</a></span><span class='op'>(</span><span class='va'>matA</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
  <span class='va'>dm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rle.html'>rle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Mod</a></span><span class='op'>(</span><span class='va'>eig</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>values</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>dm</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>/</span> <span class='va'>dm</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>#Second, run the perturbation analysis using demog_stat = "damping".</span>
<span class='fu'>perturb_trans</span><span class='op'>(</span><span class='va'>matU</span>, <span class='va'>matF</span>, demog_stat <span class='op'>=</span> <span class='st'>"damping"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $stasis
#&gt; [1] 0.2627447
#&gt; 
#&gt; $retro
#&gt; [1] 3.807707
#&gt; 
#&gt; $progr
#&gt; [1] -4.831068
#&gt; 
#&gt; $fecundity
#&gt; [1] 1.276311
#&gt; 
#&gt; $clonality
#&gt; [1] NA
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Patrick Barks, Pol Capdevila, Judy P. Che-Castaldo, John Jackson, Tamora James, Owen Jones, Sam Levin, William K. Petry, Roberto Salguero-Gomez, Iain Stott, Chelsea C. Thomas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


