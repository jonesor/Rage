<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate age-specific traits from a matrix population model — age_from_stage • Rage</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate age-specific traits from a matrix population model — age_from_stage" />
<meta property="og:description" content="These functions use age-from-stage decomposition methods to calculate
age-specific survivorship (lx), survival probability (px), mortality hazard
(hx), or reproduction (mx) from a matrix population model (MPM). A detailed
description of these methods can be found in sections 5.3.1 and 5.3.2 of
Caswell (2001)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/a01_GettingStarted.html">Getting started with Rage</a>
    </li>
    <li>
      <a href="../articles/a02_VitalRates.html">Deriving vital rates from an MPM</a>
    </li>
    <li>
      <a href="../articles/a03_LifeHistoryTraits.html">Deriving life history traits from an MPM</a>
    </li>
    <li>
      <a href="../articles/a04_AgeFromStage.html">Age-from-stage analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jonesor/Rage/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate age-specific traits from a matrix population model</h1>
    <small class="dont-index">Source: <a href='https://github.com/jonesor/Rage/blob/master/R/mpm_to_.R'><code>R/mpm_to_.R</code></a></small>
    <div class="hidden name"><code>age_from_stage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions use age-from-stage decomposition methods to calculate
age-specific survivorship (lx), survival probability (px), mortality hazard
(hx), or reproduction (mx) from a matrix population model (MPM). A detailed
description of these methods can be found in sections 5.3.1 and 5.3.2 of
Caswell (2001).</p>
    </div>

    <pre class="usage"><span class='fu'>mpm_to_mx</span><span class='op'>(</span><span class='va'>matU</span>, <span class='va'>matR</span>, start <span class='op'>=</span> <span class='fl'>1L</span>, xmax <span class='op'>=</span> <span class='fl'>1e+05</span>, lx_crit <span class='op'>=</span> <span class='fl'>1e-04</span>, tol <span class='op'>=</span> <span class='fl'>1e-04</span><span class='op'>)</span>

<span class='fu'>mpm_to_lx</span><span class='op'>(</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='fl'>1L</span>, xmax <span class='op'>=</span> <span class='fl'>1e+05</span>, lx_crit <span class='op'>=</span> <span class='fl'>1e-04</span>, tol <span class='op'>=</span> <span class='fl'>1e-04</span><span class='op'>)</span>

<span class='fu'>mpm_to_px</span><span class='op'>(</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='fl'>1L</span>, xmax <span class='op'>=</span> <span class='fl'>1e+05</span>, lx_crit <span class='op'>=</span> <span class='fl'>1e-04</span>, tol <span class='op'>=</span> <span class='fl'>1e-04</span><span class='op'>)</span>

<span class='fu'>mpm_to_hx</span><span class='op'>(</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='fl'>1L</span>, xmax <span class='op'>=</span> <span class='fl'>1e+05</span>, lx_crit <span class='op'>=</span> <span class='fl'>1e-04</span>, tol <span class='op'>=</span> <span class='fl'>1e-04</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>matU</th>
      <td><p>The survival component of a MPM (i.e. a
square projection matrix reflecting survival-related transitions; e.g.
progression, stasis, and retrogression). Optionally with named rows and
columns indicating the corresponding life stage names.</p></td>
    </tr>
    <tr>
      <th>matR</th>
      <td><p>The reproductive component of a MPM (i.e. a
square projection matrix reflecting transitions due to reproduction; either
sexual, clonal, or both). Optionally with named rows and columns indicating
the corresponding life stage names.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>The index (or stage name) of the first stage at which the author
considers the beginning of life. Defaults to 1. Alternately, a numeric vector
giving the starting population vector (in which case <code><a href='https://rdrr.io/r/base/length.html'>length(start)</a></code>
must match <code>ncol(matU))</code>. See section <em>Starting from multiple stages</em>.</p></td>
    </tr>
    <tr>
      <th>xmax</th>
      <td><p>Maximum age to which age-specific traits will be calculated
(defaults to <code>100000</code>).</p></td>
    </tr>
    <tr>
      <th>lx_crit</th>
      <td><p>Minimum value of lx to which age-specific traits will be
calculated (defaults to <code>0.0001</code>).</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>To account for floating point errors that occasionally lead to
values of lx slightly greater than 1, values of lx within the open interval
(<code>1</code>, <code>1 + tol</code>) are coerced to 1. Defaults to <code>0.0001</code>. To
prevent coercion, set <code>tol</code> to <code>0</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The output vector is calculated recursively until the age class (x)
  reaches <code>xmax</code> or survivorship (lx) falls below <code>lx_crit</code>,
  whichever comes first. To force calculation to <code>xmax</code>, set
  <code>lx_crit</code> to <code>0</code>. Conversely, to force calculation to
  <code>lx_crit</code>, set <code>xmax</code> to <code>Inf</code>.</p>
    <h2 class="hasAnchor" id="starting-from-multiple-stages"><a class="anchor" href="#starting-from-multiple-stages"></a>Starting from multiple stages</h2>

    

<p>Rather than specifying argument <code>start</code> as a single stage class from
which all individuals start life, it may sometimes be desirable to allow for
multiple starting stage classes. For example, if users want to start their
calculation of age-specific traits from reproductive maturity (i.e. first
reproduction), they should account for the possibility that there may be
multiple stage classes in which an individual could first reproduce.</p>
<p>To specify multiple starting stage classes, users should specify argument
<code>start</code> as the desired starting population vector (<strong>n1</strong>), giving
the proportion of individuals starting in each stage class (the length of
<code>start</code> should match the number of columns in the relevant MPM).</p>
<p>See function <code><a href='repro_maturity.html'>mature_distrib</a></code> for calculating the proportion of
individuals achieving reproductive maturity in each stage class.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Caswell, H. 2001. Matrix Population Models: Construction,
  Analysis, and Interpretation. Sinauer Associates; 2nd edition. ISBN:
  978-0878930968</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='lifetable_convert.html'>lifetable_convert</a></code></p>
<p>Other life tables: 
<code><a href='lifetable_convert.html'>lifetable_convert</a></code>,
<code><a href='mpm_to_table.html'>mpm_to_table</a>()</code>,
<code><a href='qsd_converge.html'>qsd_converge</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Roberto Salguero-Gómez &lt;rob.salguero@zoo.ox.ac.uk&gt;</p>
<p>Hal Caswell &lt;h.caswell@uva.nl&gt;</p>
<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>)</span>

<span class='co'># age-specific survivorship</span>
<span class='fu'>mpm_to_lx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 1.000000e+00 1.500000e-01 4.000000e-02 1.984000e-02 1.241465e-02
#&gt;  [6] 8.437150e-03 5.872905e-03 4.122125e-03 2.900967e-03 2.043401e-03
#&gt; [11] 1.439762e-03 1.014540e-03 7.149255e-04 5.037985e-04 3.550213e-04
#&gt; [16] 2.501799e-04 1.762993e-04 1.242363e-04 8.754812e-05</div><div class='input'><span class='fu'>mpm_to_lx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>       <span class='co'># starting from stage 2</span>
</div><div class='output co'>#&gt;  [1] 1.0000000000 0.5000000000 0.3168000000 0.2086130000 0.1439137100
#&gt;  [6] 0.1005837911 0.0706967003 0.0497750832 0.0350660912 0.0247084304
#&gt; [11] 0.0174112681 0.0122694301 0.0086461194 0.0060928288 0.0042935549
#&gt; [16] 0.0030256254 0.0021321283 0.0015024897 0.0010587897 0.0007461186
#&gt; [21] 0.0005257824 0.0003705137 0.0002610973 0.0001839927 0.0001296578
#&gt; [26] 0.0000913686</div><div class='input'><span class='fu'>mpm_to_lx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='st'>"small"</span><span class='op'>)</span> <span class='co'># equivalent using named life stages</span>
</div><div class='output co'>#&gt;  [1] 1.0000000000 0.5000000000 0.3168000000 0.2086130000 0.1439137100
#&gt;  [6] 0.1005837911 0.0706967003 0.0497750832 0.0350660912 0.0247084304
#&gt; [11] 0.0174112681 0.0122694301 0.0086461194 0.0060928288 0.0042935549
#&gt; [16] 0.0030256254 0.0021321283 0.0015024897 0.0010587897 0.0007461186
#&gt; [21] 0.0005257824 0.0003705137 0.0002610973 0.0001839927 0.0001296578
#&gt; [26] 0.0000913686</div><div class='input'><span class='fu'>mpm_to_lx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, xmax <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>       <span class='co'># to a maximum age of 10</span>
</div><div class='output co'>#&gt;  [1] 1.000000000 0.150000000 0.040000000 0.019840000 0.012414650 0.008437150
#&gt;  [7] 0.005872905 0.004122125 0.002900967 0.002043401 0.001439762</div><div class='input'><span class='fu'>mpm_to_lx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, lx_crit <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>  <span class='co'># to a minimum lx of 0.05</span>
</div><div class='output co'>#&gt; [1] 1.00 0.15 0.04</div><div class='input'>
<span class='co'># age-specific survival probability</span>
<span class='fu'>mpm_to_px</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 0.1500000 0.2666667 0.4960000 0.6257384 0.6796124 0.6960768 0.7018887
#&gt;  [8] 0.7037551 0.7043863 0.7045908 0.7046580 0.7046797 0.7046868 0.7046890
#&gt; [15] 0.7046898 0.7046900 0.7046901 0.7046901        NA</div><div class='input'>
<span class='co'># age-specific mortality hazard</span>
<span class='fu'>mpm_to_hx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 1.8971200 1.3217558 0.7011794 0.4688229 0.3862326 0.3622953 0.3539804
#&gt;  [8] 0.3513249 0.3504283 0.3501381 0.3500427 0.3500119 0.3500019 0.3499987
#&gt; [15] 0.3499976 0.3499973 0.3499972 0.3499971        NA</div><div class='input'>
<span class='co'># age-specific fecundity</span>
<span class='fu'>mpm_to_mx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, <span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matF</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1]  0.00000  0.00000  9.54125 19.49277 24.83256 26.79977 27.50641 27.74123
#&gt;  [9] 27.81971 27.84525 27.85359 27.85629 27.85716 27.85744 27.85753 27.85756
#&gt; [17] 27.85757 27.85757 27.85757</div><div class='input'>

<span class='co'>### starting from first reproduction</span>
<span class='va'>repstages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='repro_stages.html'>repro_stages</a></span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matF</span><span class='op'>)</span>
<span class='va'>n1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='repro_maturity.html'>mature_distrib</a></span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='fl'>2</span>, repro_stages <span class='op'>=</span> <span class='va'>repstages</span><span class='op'>)</span>

<span class='fu'>mpm_to_lx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='va'>n1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 1.000000e+00 6.757895e-01 4.489395e-01 3.128425e-01 2.192478e-01
#&gt;  [6] 1.542806e-01 1.086618e-01 7.656074e-02 5.394868e-02 3.801646e-02
#&gt; [11] 2.678968e-02 1.887839e-02 1.330341e-02 9.374777e-03 6.606313e-03
#&gt; [16] 4.655403e-03 3.280617e-03 2.311818e-03 1.629115e-03 1.148022e-03
#&gt; [21] 8.089994e-04 5.700939e-04 4.017395e-04 2.831019e-04 1.994991e-04
#&gt; [26] 1.405850e-04 9.906889e-05</div><div class='input'><span class='fu'>mpm_to_px</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='va'>n1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 0.6757895 0.6643185 0.6968478 0.7008247 0.7036818 0.7043125 0.7045783
#&gt;  [8] 0.7046521 0.7046783 0.7046862 0.7046889 0.7046897 0.7046900 0.7046901
#&gt; [15] 0.7046901 0.7046901 0.7046901 0.7046901 0.7046901 0.7046901 0.7046901
#&gt; [22] 0.7046901 0.7046901 0.7046901 0.7046901 0.7046901        NA</div><div class='input'><span class='fu'>mpm_to_hx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, start <span class='op'>=</span> <span class='va'>n1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 0.3918737 0.4089935 0.3611882 0.3554975 0.3514291 0.3505331 0.3501558
#&gt;  [8] 0.3500511 0.3500139 0.3500026 0.3499989 0.3499977 0.3499973 0.3499972
#&gt; [15] 0.3499971 0.3499971 0.3499971 0.3499971 0.3499971 0.3499971 0.3499971
#&gt; [22] 0.3499971 0.3499971 0.3499971 0.3499971 0.3499971        NA</div><div class='input'><span class='fu'>mpm_to_mx</span><span class='op'>(</span><span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matU</span>, <span class='va'>mpm1</span><span class='op'>$</span><span class='va'>matF</span>, start <span class='op'>=</span> <span class='va'>n1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 20.08684 23.58049 26.70449 27.41101 27.72566 27.81222 27.84348 27.85293
#&gt;  [9] 27.85610 27.85709 27.85742 27.85752 27.85756 27.85757 27.85757 27.85757
#&gt; [17] 27.85757 27.85757 27.85757 27.85757 27.85757 27.85757 27.85757 27.85757
#&gt; [25] 27.85757 27.85757 27.85757</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Patrick Barks, Pol Capdevila, Hal Caswell, Judy P. Che-Castaldo, John Jackson, Tamora James, Owen Jones, Sam Levin, William K. Petry, Roberto Salguero-Gomez, Iain Stott, Chelsea C. Thomas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


