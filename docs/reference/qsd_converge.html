<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate time to reach quasi-stationary stage distribution — qsd_converge • Rage</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate time to reach quasi-stationary stage distribution — qsd_converge"><meta property="og:description" content="Calculates the time for a cohort projected with a matrix population
model to reach a defined quasi-stationary stage distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a01_GettingStarted.html">Getting started with Rage</a>
    </li>
    <li>
      <a href="../articles/a02_VitalRates.html">Deriving vital rates from an MPM</a>
    </li>
    <li>
      <a href="../articles/a03_LifeHistoryTraits.html">Deriving life history traits from an MPM</a>
    </li>
    <li>
      <a href="../articles/a04_AgeFromStage.html">Age-from-stage analyses</a>
    </li>
    <li>
      <a href="../articles/a05_SuggestedQualityControl.html">Suggested quality control</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jonesor/Rage/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate time to reach quasi-stationary stage distribution</h1>
    <small class="dont-index">Source: <a href="https://github.com/jonesor/Rage/blob/HEAD/R/qsd_converge.R" class="external-link"><code>R/qsd_converge.R</code></a></small>
    <div class="hidden name"><code>qsd_converge.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the time for a cohort projected with a matrix population
model to reach a defined quasi-stationary stage distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qsd_converge</span><span class="op">(</span><span class="va">mat</span>, start <span class="op">=</span> <span class="fl">1L</span>, conv <span class="op">=</span> <span class="fl">0.01</span>, N <span class="op">=</span> <span class="fl">100000L</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mat</dt>
<dd><p>A matrix population model, or component thereof (i.e., a square
projection matrix). Optionally with named rows and columns indicating the
corresponding life stage names.</p></dd>


<dt>start</dt>
<dd><p>The index (or stage name) of the first stage at which the author
considers the beginning of life. Defaults to <code>1</code>. Alternately, a
numeric vector giving the starting population vector (in which case
<code>length(start)</code> must match <code>ncol(matU))</code>. See section
<em>Starting from multiple stages</em>.</p></dd>


<dt>conv</dt>
<dd><p>Proportional distance threshold from the stationary stage
distribution indicating convergence. For example, this value should be
<code>0.01</code> if the user wants to obtain the time step when the stage
distribution is within a distance of 1% of the stationary stage
distribution.</p></dd>


<dt>N</dt>
<dd><p>Maximum number of time steps over which the population will be
projected. Time steps are in the same units as the matrix population model
(see <code>AnnualPeriodicity</code> column in COM(P)ADRE metadata). Defaults to
<code>100,000</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An integer indicating the first time step at which the
  quasi-stationary stage distribution is reached (or an <code>NA</code> and a
  warning if the quasi-stationary distribution is not reached).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Some matrix population models are parameterised with a stasis loop at the
largest/most-developed stage class, which can lead to artefactual plateaus
in the mortality or fertility trajectories derived from such models. These
plateaus occur as a projected cohort approaches its stationary stage
distribution (SSD). Though there is generally no single time point at which
the SSD is reached, we can define a quasi-stationary stage distribution (QSD)
based on a given distance threshold from the SSD, and calculate the number of
time steps required for a cohort to reach the QSD. This quantity can then be
used to subset age trajectories of mortality or fertility to periods earlier
than the QSD, so as to avoid artefactual plateaus in mortality or fertility.</p>
<p><strong>Starting from multiple stages</strong></p>
<p>Rather than specifying argument <code>start</code> as a single stage class from
which all individuals start life, it may sometimes be desirable to allow for
multiple starting stage classes. For example, if we want to start our
calculation of QSD from reproductive maturity (i.e., first reproduction), we
should account for the possibility that there may be multiple stage classes
in which an individual could first reproduce.</p>
<p>To specify multiple starting stage classes, specify argument <code>start</code> as
the desired starting population vector, giving the proportion
of individuals starting in each stage class (the length of <code>start</code>
should match the number of columns in the relevant MPM).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The time required for a cohort to reach its QSD depends on the initial
  population vector of the cohort (for our purposes, the starting stage
  class), and so does not fundamentally require an ergodic matrix (where the
  long-term equilibrium traits are independent of the initial population
  vector). However, methods for efficiently calculating the stationary stage
  distribution (SSD) generally do require ergodicity.</p>
<p>If the supplied matrix (<code>mat</code>) is non-ergodic, <code>qsd_converge</code>
  first checks for stage classes with no connection (of any degree) from the
  starting stage class specified by argument <code>start</code>, and strips such
  stages from the matrix. These unconnected stages have no impact on
  age-specific traits that we might derive from the matrix (given the
  specified starting stage), but often lead to non-ergodicity and therefore
  prevent the reliable calculation of SSD. If the reduced matrix is ergodic,
  the function internally updates the starting stage class and continues with
  the regular calculation. Otherwise, if the matrix cannot be made ergodic,
  the function will return <code>NA</code> with a warning.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Caswell, H. 2001. Matrix Population Models: Construction, Analysis, and
Interpretation. Sinauer Associates; 2nd edition. ISBN: 978-0878930968</p>
<p>Horvitz, C. C., &amp; Tuljapurkar, S. 2008. Stage dynamics, period survival, and
mortality plateaus. The American Naturalist, 172(2), 203–215.</p>
<p>Jones, O. R., Scheuerlein, A., Salguero-Gomez, R., Camarda, C. G., Schaible,
R., Casper, B. B., Dahlgren, J. P., Ehrlén, J., García, M. B., Menges, E.,
Quintana-Ascencio, P. F., Caswell, H., Baudisch, A. &amp; Vaupel, J. 2014.
Diversity of ageing across the tree of life. Nature 505, 169-173.
&lt;doi:10.1038/nature12789&gt;</p>
<p>Salguero-Gomez R. 2018. Implications of clonality for ageing research.
Evolutionary Ecology, 32, 9-28. &lt;doi:10.1007/s10682-017-9923-2&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="repro_maturity.html">mature_distrib</a></code> for calculating the proportion of
individuals achieving reproductive maturity in each stage class.</p>
<p>Other life tables: 
<code><a href="age_from_stage.html">age_from_stage</a></code>,
<code><a href="lifetable_convert.html">lifetable_convert</a></code>,
<code><a href="mpm_to_table.html">mpm_to_table</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Hal Caswell &lt;h.caswell@uva.nl&gt;</p>
<p>Owen Jones &lt;jones@biology.sdu.dk&gt;</p>
<p>Roberto Salguero-Gomez &lt;rob.salguero@zoo.ox.ac.uk&gt;</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mpm1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># starting stage = 2 (i.e., "small")</span></span></span>
<span class="r-in"><span><span class="fu">qsd_converge</span><span class="op">(</span><span class="va">mpm1</span><span class="op">$</span><span class="va">matU</span>, start <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-in"><span><span class="fu">qsd_converge</span><span class="op">(</span><span class="va">mpm1</span><span class="op">$</span><span class="va">matU</span>, start <span class="op">=</span> <span class="st">"small"</span><span class="op">)</span> <span class="co"># equivalent using named life stages</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convergence threshold = 0.001</span></span></span>
<span class="r-in"><span><span class="fu">qsd_converge</span><span class="op">(</span><span class="va">mpm1</span><span class="op">$</span><span class="va">matU</span>, start <span class="op">=</span> <span class="fl">2</span>, conv <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># starting from first reproduction</span></span></span>
<span class="r-in"><span><span class="va">repstages</span> <span class="op">&lt;-</span> <span class="fu"><a href="repro_stages.html">repro_stages</a></span><span class="op">(</span><span class="va">mpm1</span><span class="op">$</span><span class="va">matF</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="repro_maturity.html">mature_distrib</a></span><span class="op">(</span><span class="va">mpm1</span><span class="op">$</span><span class="va">matU</span>, start <span class="op">=</span> <span class="fl">2</span>, repro_stages <span class="op">=</span> <span class="va">repstages</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qsd_converge</span><span class="op">(</span><span class="va">mpm1</span><span class="op">$</span><span class="va">matU</span>, start <span class="op">=</span> <span class="va">n1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Barks, Pol Capdevila, Hal Caswell, Judy P. Che-Castaldo, Richard A. Hinrichsen, John Jackson, Tamora James, Owen Jones, Sam Levin, William K. Petry, Roberto Salguero-Gomez, Iain Stott, Chelsea C. Thomas, Christina M. Hernández, Lotte de Vries, Stefano Giaimo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

